@{
    ViewData["Title"] = "Historial de Ventas";
}

<div class="card p-4 shadow-sm border-0">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-0 text-dark"><i class="fas fa-history text-primary"></i> Historial de Ventas</h2>
            <small class="text-muted">Consulta de facturas emitidas</small>
        </div>
        <a asp-controller="Ventas" asp-action="Index" class="btn btn-success shadow-sm">
            <i class="fas fa-cash-register me-2"></i> Nueva Venta
        </a>
    </div>

    <div class="table-responsive">
        <table id="tablaFacturas" class="table table-hover align-middle">
            <thead class="table-light">
                <tr>
                    <th>Folio</th>
                    <th>Fecha y Hora</th>
                    <th>Cliente</th>
                    <th>Total</th>
                    <th class="text-end">Acciones</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

@section Scripts {
    <script src="~/js/almacen-core.js"></script>
    <script>
        const manager = new DataManager('/Facturas/GetJson');

        const columnas = [
            {
                data: 'idFactura',
                render: (i) => `<span class="badge bg-light text-dark border">#${i.idFactura}</span>`
            },
            { data: 'fecha' },
            {
                data: 'cliente',
                render: (i) => `<strong class="text-dark">${i.cliente}</strong>`
            },
            {
                data: 'total',
                render: (i) => `<span class="fw-bold text-success">$${i.total.toFixed(2)}</span>`
            },
            {
                render: (i) => `
                    <div class="text-end">
                        <a href="/Facturas/Details/${i.idFactura}" class="btn btn-sm btn-outline-primary" title="Ver Ticket">
                            <i class="fas fa-receipt me-1"></i> Ver Ticket
                        </a>
                    </div>
                `
            }
        ];

        document.addEventListener("DOMContentLoaded", () => {
            manager.loadTable('tablaFacturas', columnas);
        });
    </script>
}